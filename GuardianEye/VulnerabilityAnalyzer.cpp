#include "VulnerabilityAnalyzer.hpp"
#include <iostream>
#include <map>

IdentifiedService VulnerabilityAnalyzer::identifyService(int port) {
    IdentifiedService identifiedService;
    identifiedService.port = port;

    std::map<int, std::string> vulnerableServices;
    vulnerableServices[80] = "HTTP server with known vulnerabilities";
    vulnerableServices[21] = "FTP server with known vulnerabilities";

    auto it = vulnerableServices.find(port);
    if (it != vulnerableServices.end()) {
        identifiedService.service = it->second;
    } else {
        identifiedService.service = "Unknown service";
    }

    return identifiedService;
}
